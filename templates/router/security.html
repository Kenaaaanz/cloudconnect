<!-- templates/router/security.html -->
{% extends 'router/base_router.html' %}

{% block router_content %}
<div class="bg-white rounded-xl shadow-sm p-6">
    <h2 class="text-2xl font-semibold mb-6 flex items-center">
        <i class="fas fa-shield-alt text-blue-500 mr-3"></i>
        Security Settings
    </h2>

    <!-- Security Status Card -->
    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
        <div class="flex items-start">
            <i class="fas fa-info-circle text-blue-500 mt-1 mr-3"></i>
            <div>
                <h3 class="font-medium text-blue-800">Security Status: 
                    <span class="{% if router.security_status == 'Excellent' %}text-green-600
                                 {% elif router.security_status == 'Good' %}text-blue-600
                                 {% elif router.security_status == 'Fair' %}text-yellow-600
                                 {% else %}text-red-600{% endif %}">
                        {{ router.security_status }}
                    </span>
                </h3>
                <p class="text-blue-700 text-sm mt-1">
                    Your router's security is {{ router.security_status|lower }}. 
                    {% if router.security_status == 'Excellent' %}Keep up the good work!
                    {% elif router.security_status == 'Good' %}Consider enabling additional security features.
                    {% elif router.security_status == 'Fair' %}We recommend improving your security settings.
                    {% else %}Your network may be vulnerable. Please take action.{% endif %}
                </p>
            </div>
        </div>
    </div>

    <form method="post">
        {% csrf_token %}
        
        <!-- Firewall Settings -->
        <div class="card mb-6">
            <h3 class="card-title">
                <i class="fas fa-fire text-blue-500 mr-2"></i>
                Firewall Protection
            </h3>
            <div class="flex items-center justify-between py-3">
                <div>
                    <h4 class="font-medium">Enable Firewall</h4>
                    <p class="text-sm text-gray-600">Protects your network from unauthorized access</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" name="firewall_enabled" {% if router.firewall_enabled %}checked{% endif %}>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Remote Access -->
        <div class="card mb-6">
            <h3 class="card-title">
                <i class="fas fa-globe text-blue-500 mr-2"></i>
                Remote Management
            </h3>
            <div class="flex items-center justify-between py-3">
                <div>
                    <h4 class="font-medium">Remote Access</h4>
                    <p class="text-sm text-gray-600">Allow router management from outside your network</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" name="remote_access" {% if router.remote_access %}checked{% endif %}>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- UPnP Settings -->
        <div class="card mb-6">
            <h3 class="card-title">
                <i class="fas fa-plug text-blue-500 mr-2"></i>
                UPnP (Universal Plug and Play)
            </h3>
            <div class="flex items-center justify-between py-3">
                <div>
                    <h4 class="font-medium">Enable UPnP</h4>
                    <p class="text-sm text-gray-600">Allows devices to automatically configure network settings</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" name="upnp_enabled" {% if router.upnp_enabled %}checked{% endif %}>
                    <span class="slider"></span>
                </label>
            </div>
            <p class="text-sm text-yellow-600 mt-2">
                <i class="fas fa-exclamation-triangle mr-1"></i>
                Note: UPnP can be a security risk. Only enable if necessary.
            </p>
        </div>

        <!-- MAC Filtering -->
        <div class="card mb-6">
            <h3 class="card-title">
                <i class="fas fa-filter text-blue-500 mr-2"></i>
                MAC Address Filtering
            </h3>
            <p class="text-sm text-gray-600 mb-4">Control which devices can connect to your network</p>
            
            <div class="flex items-center justify-between py-3">
                <div>
                    <h4 class="font-medium">Enable MAC Filtering</h4>
                    <p class="text-sm text-gray-600">Only allow devices with approved MAC addresses</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" name="mac_filtering" {% if router.mac_filtering %}checked{% endif %}>
                    <span class="slider"></span>
                </label>
            </div>

            {% if mac_filtering_devices %}
            <div class="mt-4">
                <h4 class="font-medium mb-2">Approved Devices</h4>
                <div class="bg-gray-50 rounded-lg p-3">
                    {% for device in mac_filtering_devices %}
                    <div class="flex items-center justify-between py-2">
                        <span class="text-sm">{{ device.name }} ({{ device.mac_address }})</span>
                        <button type="button" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Save Button -->
        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-6 rounded-lg flex items-center">
            <i class="fas fa-save mr-2"></i> Save Security Settings
        </button>
    </form>
</div>

<style>
    .card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        margin-bottom: 20px;
    }
    
    .card-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
    }
    
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 26px;
    }
    
    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 34px;
    }
    
    .slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    
    input:checked + .slider {
        background-color: #4361ee;
    }
    
    input:checked + .slider:before {
        transform: translateX(24px);
    }
</style>
{% endblock %}
       